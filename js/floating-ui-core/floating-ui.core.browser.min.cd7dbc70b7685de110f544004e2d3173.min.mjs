function t(e){return e.split("-")[1]}function e(e){return"y"===e?"height":"width"}function n(e){return e.split("-")[0]}function o(e){return["top","bottom"].includes(n(e))?"x":"y"}function i(p,c,d){let{reference:s,floating:a}=p;const f=s.x+s.width/2-a.width/2,l=s.y+s.height/2-a.height/2,r=o(c),u=e(r),h=s[u]/2-a[u]/2,m="x"===r;let i;switch(n(c)){case"top":i={x:f,y:s.y-a.height};break;case"bottom":i={x:f,y:s.y+s.height};break;case"right":i={x:s.x+s.width,y:l};break;case"left":i={x:s.x-a.width,y:l};break;default:i={x:s.x,y:s.y}}switch(t(c)){case"start":i[r]-=h*(d&&m?-1:1);break;case"end":i[r]+=h*(d&&m?-1:1)}return i}const r=async(l,o,p)=>{const{placement:d="bottom",strategy:r="absolute",middleware:f=[],platform:n}=p,u=f.filter(Boolean),h=await(null==n.isRTL?void 0:n.isRTL(o));let a=await n.getElementRects({reference:l,floating:o,strategy:r}),{x:e,y:s}=i(a,d,h),c=d,t={},m=0;for(let p=0;p<u.length;p++){const{name:g,fn:j}=u[p],{x:v,y:b,data:y,reset:f}=await j({x:e,y:s,initialPlacement:d,placement:c,strategy:r,middlewareData:t,rects:a,platform:n,elements:{reference:l,floating:o}});e=v??e,s=b??s,t={...t,[g]:{...t[g],...y}},f&&m<=50&&(m++,"object"==typeof f&&(f.placement&&(c=f.placement),f.rects&&(a=!0===f.rects?await n.getElementRects({reference:l,floating:o,strategy:r}):f.rects),{x:e,y:s}=i(a,c,h)),p=-1)}return{x:e,y:s,placement:c,strategy:r,middlewareData:t}};function a(e,t){return"function"==typeof e?e(t):e}function l(e){return"number"!=typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}function s(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}async function c(v,d){var g;void 0===d&&(d={});const{x:w,y:_,platform:e,rects:p,elements:u,strategy:f}=v,{boundary:y="clippingAncestors",rootBoundary:O="viewport",elementContext:c="floating",altBoundary:j=!1,padding:b=0}=a(d,v),n=l(b),h=u[j?"floating"===c?"reference":"floating":c],o=s(await e.getClippingRect({element:null==(g=await(null==e.isElement?void 0:e.isElement(h)))||g?h:h.contextElement||await(null==e.getDocumentElement?void 0:e.getDocumentElement(u.floating)),boundary:y,rootBoundary:O,strategy:f})),m="floating"===c?{...p.floating,x:w,y:_}:p.reference,r=await(null==e.getOffsetParent?void 0:e.getOffsetParent(u.floating)),i=await(null==e.isElement?void 0:e.isElement(r))&&await(null==e.getScale?void 0:e.getScale(r))||{x:1,y:1},t=s(e.convertOffsetParentRelativeRectToViewportRelativeRect?await e.convertOffsetParentRelativeRectToViewportRelativeRect({rect:m,offsetParent:r,strategy:f}):m);return{top:(o.top-t.top+n.top)/i.y,bottom:(t.bottom-o.bottom+n.bottom)/i.y,left:(o.left-t.left+n.left)/i.x,right:(t.right-o.right+n.right)/i.x}}const f=Math.min,m=Math.max;function u(e,t,n){return m(e,f(t,n))}const g=n=>({name:"arrow",options:n,async fn(O){const{x:R,y:L,placement:A,rects:c,platform:d,elements:N}=O,{element:v,padding:D=0}=a(n,O)||{};if(null==v)return{};const _=l(D),j={x:R,y:L},s=o(A),i=e(s),m=await d.getDimensions(v),b="y"===s,S=b?"top":"left",z=b?"bottom":"right",C=b?"clientHeight":"clientWidth",T=c.reference[i]+c.reference[s]-j[s]-c.floating[i],F=j[s]-c.reference[s],y=await(null==d.getOffsetParent?void 0:d.getOffsetParent(v));let h=y?y[C]:0;h&&await(null==d.isElement?void 0:d.isElement(y))||(h=N.floating[C]||c.floating[i]);const M=T/2-F/2,k=h/2-m[i]/2-1,E=f(_[S],k),x=f(_[z],k),p=E,w=h-m[i]-x,r=h/2-m[i]/2+M,g=u(p,r,w),P=null!=t(A)&&r!=g&&c.reference[i]/2-(r<p?E:x)-m[i]/2<0;return{[s]:j[s]-(P?r<p?p-r:w-r:0),data:{[s]:g,centerOffset:r-g}}}}),d=["top","right","bottom","left"],p=d.reduce((t,e)=>t.concat(e,e+"-start",e+"-end"),[]),h={left:"right",right:"left",bottom:"top",top:"bottom"};function y(e){return e.replace(/left|right|bottom|top/g,e=>h[e])}function x(l,i,s){void 0===s&&(s=!1);const a=t(l),r=o(l),c=e(r);let n="x"===r?a===(s?"end":"start")?"right":"left":"start"===a?"bottom":"top";return i.reference[c]>i.floating[c]&&(n=y(n)),{main:n,cross:y(n)}}const w={start:"end",end:"start"};function v(e){return e.replace(/start|end/g,e=>w[e])}const b=function(e){return void 0===e&&(e={}),{name:"autoPlacement",options:e,async fn(r){var _,y,j;const{rects:F,middlewareData:f,placement:m,platform:h,elements:M}=r,{crossAxis:S=!1,alignment:g,allowedPlacements:l=p,autoAlignment:T=!0,...C}=a(e,r),i=void 0!==g||l===p?function(e,o,s){return(e?[...s.filter(n=>t(n)===e),...s.filter(n=>t(n)!==e)]:s.filter(e=>n(e)===e)).filter(n=>!e||t(n)===e||!!o&&v(n)!==n)}(g||null,T,l):l,u=await c(r,C),o=(null==(_=f.autoPlacement)?void 0:_.index)||0,s=i[o];if(null==s)return{};const{main:E,cross:k}=x(s,F,await(null==h.isRTL?void 0:h.isRTL(M.floating)));if(m!==s)return{reset:{placement:i[0]}};const A=[u[n(s)],u[E],u[k]],d=[...(null==(y=f.autoPlacement)?void 0:y.overflows)||[],{placement:s,overflows:A}],w=i[o+1];if(w)return{data:{index:o+1,overflows:d},reset:{placement:w}};const b=d.map(e=>{const n=t(e.placement);return[e.placement,n&&S?e.overflows.slice(0,2).reduce((e,t)=>e+t,0):e.overflows[0],e.overflows]}).sort((e,t)=>e[1]-t[1]),O=(null==(j=b.filter(e=>e[2].slice(0,t(e[0])?2:3).every(e=>e<=0))[0])?void 0:j[0])||b[0][0];return O!==m?{data:{index:o+1,overflows:d},reset:{placement:O}}:{}}}},A=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(l){var j,h,f,O;const{placement:i,middlewareData:g,rects:T,initialPlacement:s,platform:m,elements:F}=l,{mainAxis:M=!0,crossAxis:S=!0,fallbackPlacements:p,fallbackStrategy:A="bestFit",fallbackAxisSideDirection:b="none",flipAlignment:w=!0,...k}=a(e,l),E=n(i),C=n(s)===s,u=await(null==m.isRTL?void 0:m.isRTL(F.floating)),_=p||(C||!w?[y(s)]:function(e){const t=y(e);return[v(e),t,v(t)]}(s));p||"none"===b||_.push(...function(s,i,a,r){const o=t(s);let e=function(s,e,o){const t=["left","right"],n=["right","left"],i=["top","bottom"],a=["bottom","top"];switch(s){case"top":case"bottom":return o?e?n:t:e?t:n;case"left":case"right":return e?i:a;default:return[]}}(n(s),"start"===a,r);return o&&(e=e.map(e=>e+"-"+o),i&&(e=e.concat(e.map(v)))),e}(s,w,b,u));const z=[s,..._],d=await c(l,k),r=[];let o=(null==(j=g.flip)?void 0:j.overflows)||[];if(M&&r.push(d[E]),S){const{main:e,cross:t}=x(i,T,u);r.push(d[e],d[t])}if(o=[...o,{placement:i,overflows:r}],!r.every(e=>e<=0)){const t=((null==(h=g.flip)?void 0:h.index)||0)+1,n=z[t];if(n)return{data:{index:t,overflows:o},reset:{placement:n}};let e=null==(f=o.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:f.placement;if(!e)switch(A){case"bestFit":{const t=null==(O=o.map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:O[0];t&&(e=t);break}case"initialPlacement":e=s}if(i!==e)return{reset:{placement:e}}}return{}}}};function R(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function P(e){return d.some(t=>e[t]>=0)}const E=function(e){return void 0===e&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:o="referenceHidden",...s}=a(e,t);switch(o){case"referenceHidden":{const e=R(await c(t,{...s,elementContext:"reference"}),n.reference);return{data:{referenceHiddenOffsets:e,referenceHidden:P(e)}}}case"escaped":{const e=R(await c(t,{...s,altBoundary:!0}),n.floating);return{data:{escapedOffsets:e,escaped:P(e)}}}default:return{}}}}};function T(e){const t=f(...e.map(e=>e.left)),n=f(...e.map(e=>e.top));return{x:t,y:n,width:m(...e.map(e=>e.right))-t,height:m(...e.map(e=>e.bottom))-n}}const D=function(e){return void 0===e&&(e={}),{name:"inline",options:e,async fn(j){const{placement:d,elements:b,rects:c,platform:u,strategy:_}=j,{padding:y=2,x:p,y:h}=a(e,j),g=Array.from(await(null==u.getClientRects?void 0:u.getClientRects(b.reference))||[]),t=function(o){const n=o.slice().sort((e,t)=>e.y-t.y),e=[];let t=null;for(let o=0;o<n.length;o++){const s=n[o];!t||s.y-t.y>t.height/2?e.push([s]):e[e.length-1].push(s),t=s}return e.map(e=>s(T(e)))}(g),v=s(T(g)),r=l(y),i=await u.getElementRects({reference:{getBoundingClientRect:function(){if(2===t.length&&t[0].left>t[1].right&&null!=p&&null!=h)return t.find(e=>p>e.left-r.left&&p<e.right+r.right&&h>e.top-r.top&&h<e.bottom+r.bottom)||v;if(t.length>=2){if("x"===o(d)){const e=t[0],s=t[t.length-1],a="top"===n(d),o=e.top,r=s.bottom,i=a?e.left:s.left,c=a?e.right:s.right;return{top:o,bottom:r,left:i,right:c,width:c-i,height:r-o,x:i,y:o}}const c="left"===n(d),s=m(...t.map(e=>e.right)),e=f(...t.map(e=>e.left)),i=t.filter(t=>c?t.left===e:t.right===s),a=i[0].top,r=i[i.length-1].bottom;return{top:a,bottom:r,left:e,right:s,width:s-e,height:r-a,x:e,y:a}}return v}},floating:b.floating,strategy:_});return c.reference.x!==i.reference.x||c.reference.y!==i.reference.y||c.reference.width!==i.reference.width||c.reference.height!==i.reference.height?{reset:{rects:i}}:{}}}},L=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(i){const{x:r,y:c}=i,s=await async function(f,b){const{placement:s,platform:l,elements:v}=f,g=await(null==l.isRTL?void 0:l.isRTL(v.floating)),p=n(s),m=t(s),h="x"===o(s),c=["left","top"].includes(p)?-1:1,u=g&&h?-1:1,i=a(b,f);let{mainAxis:d,crossAxis:e,alignmentAxis:r}="number"==typeof i?{mainAxis:i,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...i};return m&&"number"==typeof r&&(e="end"===m?-1*r:r),h?{x:e*u,y:d*c}:{x:d*c,y:e*u}}(i,e);return{x:r+s.x,y:c+s.y,data:s}}}};function k(e){return"x"===e?"y":"x"}const O=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(r){const{x:m,y:p,placement:b}=r,{mainAxis:v=!0,crossAxis:g=!1,limiter:j={fn:e=>{let{x:t,y:n}=e;return{x:t,y:n}}},...y}=a(e,r),f={x:m,y:p},d=await c(r,y),i=o(n(b)),l=k(i);let s=f[i],t=f[l];if(v){const e="y"===i?"bottom":"right";s=u(s+d["y"===i?"top":"left"],s,s-d[e])}if(g){const e="y"===l?"bottom":"right";t=u(t+d["y"===l?"top":"left"],t,t-d[e])}const h=j.fn({...r,[i]:s,[l]:t});return{...h,data:{x:h.x-m,y:h.y-p}}}}},B=function(e){return void 0===e&&(e={}),{options:e,fn(d){const{x:_,y,placement:f,rects:t,middlewareData:h}=d,{offset:j=0,mainAxis:b=!0,crossAxis:v=!0}=a(e,d),p={x:_,y},s=o(f),i=k(s);let c=p[s],r=p[i];const u=a(j,d),l="number"==typeof u?{mainAxis:u,crossAxis:0}:{mainAxis:0,crossAxis:0,...u};if(b){const e="y"===s?"height":"width",n=t.reference[s]-t.floating[e]+l.mainAxis,o=t.reference[s]+t.reference[e]-l.mainAxis;c<n?c=n:c>o&&(c=o)}if(v){var m,g;const o="y"===s?"width":"height",e=["top","left"].includes(n(f)),a=t.reference[i]-t.floating[o]+(e&&(null==(m=h.offset)?void 0:m[i])||0)+(e?0:l.crossAxis),c=t.reference[i]+t.reference[o]+(e?0:(null==(g=h.offset)?void 0:g[i])||0)-(e?l.crossAxis:0);r<a?r=a:r>c&&(r=c)}return{[s]:c,[i]:r}}}},C=function(e){return void 0===e&&(e={}),{name:"size",options:e,async fn(i){const{placement:j,rects:A,platform:v,elements:w}=i,{apply:k=()=>{},...E}=a(e,i),s=await c(i,E),u=n(j),r=t(j),_="x"===o(j),{width:d,height:l}=A.floating;let y,g;"top"===u||"bottom"===u?(y=u,g=r===(await(null==v.isRTL?void 0:v.isRTL(w.floating))?"start":"end")?"left":"right"):(g=u,y="end"===r?"top":"bottom");const O=l-s[y],x=d-s[g],h=!i.middlewareData.shift;let p=O,b=x;if(_){const e=d-s.left-s.right;b=r||h?f(x,e):e}else{const e=l-s.top-s.bottom;p=r||h?f(O,e):e}if(h&&!r){const e=m(s.left,0),t=m(s.right,0),n=m(s.top,0),o=m(s.bottom,0);_?b=d-2*(0!==e||0!==t?e+t:m(s.left,s.right)):p=l-2*(0!==n||0!==o?n+o:m(s.top,s.bottom))}await k({...i,availableWidth:b,availableHeight:p});const C=await v.getDimensions(w.floating);return d!==C.width||l!==C.height?{reset:{rects:!0}}:{}}}};export{g as arrow,b as autoPlacement,r as computePosition,c as detectOverflow,A as flip,E as hide,D as inline,B as limitShift,L as offset,s as rectToClientRect,O as shift,C as size}