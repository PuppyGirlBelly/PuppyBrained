!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).FloatingUICore={})}(this,function(t){"use strict";function n(e){return e.split("-")[1]}function h(e){return"y"===e?"height":"width"}function e(e){return e.split("-")[0]}function i(t){return["top","bottom"].includes(e(t))?"x":"y"}function b(p,r,l){let{reference:t,floating:o}=p;const f=t.x+t.width/2-o.width/2,c=t.y+t.height/2-o.height/2,a=i(r),d=h(a),u=t[d]/2-o[d]/2,m="x"===a;let s;switch(e(r)){case"top":s={x:f,y:t.y-o.height};break;case"bottom":s={x:f,y:t.y+t.height};break;case"right":s={x:t.x+t.width,y:c};break;case"left":s={x:t.x-o.width,y:c};break;default:s={x:t.x,y:t.y}}switch(n(r)){case"start":s[a]-=u*(l&&m?-1:1);break;case"end":s[a]+=u*(l&&m?-1:1)}return s}function s(e,t){return"function"==typeof e?e(t):e}function u(e){return"number"!=typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}function c(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}async function r(v,l){var g;void 0===l&&(l={});const{x:w,y:_,platform:e,rects:p,elements:d,strategy:f}=v,{boundary:y="clippingAncestors",rootBoundary:O="viewport",elementContext:r="floating",altBoundary:j=!1,padding:b=0}=s(l,v),n=u(b),h=d[j?"floating"===r?"reference":"floating":r],o=c(await e.getClippingRect({element:null==(g=await(null==e.isElement?void 0:e.isElement(h)))||g?h:h.contextElement||await(null==e.getDocumentElement?void 0:e.getDocumentElement(d.floating)),boundary:y,rootBoundary:O,strategy:f})),m="floating"===r?{...p.floating,x:w,y:_}:p.reference,a=await(null==e.getOffsetParent?void 0:e.getOffsetParent(d.floating)),i=await(null==e.isElement?void 0:e.isElement(a))&&await(null==e.getScale?void 0:e.getScale(a))||{x:1,y:1},t=c(e.convertOffsetParentRelativeRectToViewportRelativeRect?await e.convertOffsetParentRelativeRectToViewportRelativeRect({rect:m,offsetParent:a,strategy:f}):m);return{top:(o.top-t.top+n.top)/i.y,bottom:(t.bottom-o.bottom+n.bottom)/i.y,left:(o.left-t.left+n.left)/i.x,right:(t.right-o.right+n.right)/i.x}}const a=Math.min,o=Math.max;function m(e,t,n){return o(e,a(t,n))}const g=["top","right","bottom","left"],f=g.reduce((t,e)=>t.concat(e,e+"-start",e+"-end"),[]),O={left:"right",right:"left",bottom:"top",top:"bottom"};function l(e){return e.replace(/left|right|bottom|top/g,e=>O[e])}function v(c,s,t){void 0===t&&(t=!1);const o=n(c),a=i(c),r=h(a);let e="x"===a?o===(t?"end":"start")?"right":"left":"start"===o?"bottom":"top";return s.reference[r]>s.floating[r]&&(e=l(e)),{main:e,cross:l(e)}}const w={start:"end",end:"start"};function d(e){return e.replace(/start|end/g,e=>w[e])}function j(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function p(e){return g.some(t=>e[t]>=0)}function y(e){const t=a(...e.map(e=>e.left)),n=a(...e.map(e=>e.top));return{x:t,y:n,width:o(...e.map(e=>e.right))-t,height:o(...e.map(e=>e.bottom))-n}}function _(e){return"x"===e?"y":"x"}t.arrow=e=>({name:"arrow",options:e,async fn(O){const{x:R,y:L,placement:A,rects:c,platform:l,elements:N}=O,{element:v,padding:D=0}=s(e,O)||{};if(null==v)return{};const _=u(D),j={x:R,y:L},t=i(A),o=h(t),f=await l.getDimensions(v),b="y"===t,S=b?"top":"left",z=b?"bottom":"right",C=b?"clientHeight":"clientWidth",T=c.reference[o]+c.reference[t]-j[t]-c.floating[o],F=j[t]-c.reference[t],y=await(null==l.getOffsetParent?void 0:l.getOffsetParent(v));let d=y?y[C]:0;d&&await(null==l.isElement?void 0:l.isElement(y))||(d=N.floating[C]||c.floating[o]);const M=T/2-F/2,k=d/2-f[o]/2-1,E=a(_[S],k),x=a(_[z],k),p=E,w=d-f[o]-x,r=d/2-f[o]/2+M,g=m(p,r,w),P=null!=n(A)&&r!=g&&c.reference[o]/2-(r<p?E:x)-f[o]/2<0;return{[t]:j[t]-(P?r<p?p-r:w-r:0),data:{[t]:g,centerOffset:r-g}}}}),e.autoPlacement=function(t){return void 0===t&&(t={}),{name:"autoPlacement",options:t,async fn(c){var w,_,y;const{rects:F,middlewareData:g,placement:p,platform:m,elements:M}=c,{crossAxis:S=!1,alignment:b,allowedPlacements:l=f,autoAlignment:T=!0,...C}=s(t,c),a=void 0!==b||l===f?function(t,o,s){return(t?[...s.filter(e=>n(e)===t),...s.filter(e=>n(e)!==t)]:s.filter(t=>e(t)===t)).filter(e=>!t||n(e)===t||!!o&&d(e)!==e)}(b||null,T,l):l,h=await r(c,C),i=(null==(w=g.autoPlacement)?void 0:w.index)||0,o=a[i];if(null==o)return{};const{main:E,cross:k}=v(o,F,await(null==m.isRTL?void 0:m.isRTL(M.floating)));if(p!==o)return{reset:{placement:a[0]}};const A=[h[e(o)],h[E],h[k]],u=[...(null==(_=g.autoPlacement)?void 0:_.overflows)||[],{placement:o,overflows:A}],O=a[i+1];if(O)return{data:{index:i+1,overflows:u},reset:{placement:O}};const j=u.map(e=>{const t=n(e.placement);return[e.placement,t&&S?e.overflows.slice(0,2).reduce((e,t)=>e+t,0):e.overflows[0],e.overflows]}).sort((e,t)=>e[1]-t[1]),x=(null==(y=j.filter(e=>e[2].slice(0,n(e[0])?2:3).every(e=>e<=0))[0])?void 0:y[0])||j[0][0];return x!==p?{data:{index:i+1,overflows:u},reset:{placement:x}}:{}}}},e.computePosition=async(c,o,f)=>{const{placement:l="bottom",strategy:a="absolute",middleware:m=[],platform:n}=f,d=m.filter(Boolean),u=await(null==n.isRTL?void 0:n.isRTL(o));let i=await n.getElementRects({reference:c,floating:o,strategy:a}),{x:e,y:s}=b(i,l,u),r=l,t={},h=0;for(let f=0;f<d.length;f++){const{name:p,fn:j}=d[f],{x:g,y:v,data:y,reset:m}=await j({x:e,y:s,initialPlacement:l,placement:r,strategy:a,middlewareData:t,rects:i,platform:n,elements:{reference:c,floating:o}});e=g??e,s=v??s,t={...t,[p]:{...t[p],...y}},m&&h<=50&&(h++,"object"==typeof m&&(m.placement&&(r=m.placement),m.rects&&(i=!0===m.rects?await n.getElementRects({reference:c,floating:o,strategy:a}):m.rects),{x:e,y:s}=b(i,r,u)),f=-1)}return{x:e,y:s,placement:r,strategy:a,middlewareData:t}},e.detectOverflow=r,e.flip=function(t){return void 0===t&&(t={}),{name:"flip",options:t,async fn(u){var _,f,g,x;const{placement:a,middlewareData:j,rects:T,initialPlacement:o,platform:p,elements:F}=u,{mainAxis:M=!0,crossAxis:S=!0,fallbackPlacements:b,fallbackStrategy:A="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:O=!0,...k}=s(t,u),E=e(a),C=e(o)===o,m=await(null==p.isRTL?void 0:p.isRTL(F.floating)),w=b||(C||!O?[l(o)]:function(e){const t=l(e);return[d(e),t,d(t)]}(o));b||"none"===y||w.push(...function(s,i,a,r){const o=n(s);let t=function(s,e,o){const t=["left","right"],n=["right","left"],i=["top","bottom"],a=["bottom","top"];switch(s){case"top":case"bottom":return o?e?n:t:e?t:n;case"left":case"right":return e?i:a;default:return[]}}(e(s),"start"===a,r);return o&&(t=t.map(e=>e+"-"+o),i&&(t=t.concat(t.map(d)))),t}(o,O,y,m));const z=[o,...w],h=await r(u,k),c=[];let i=(null==(_=j.flip)?void 0:_.overflows)||[];if(M&&c.push(h[E]),S){const{main:e,cross:t}=v(a,T,m);c.push(h[e],h[t])}if(i=[...i,{placement:a,overflows:c}],!c.every(e=>e<=0)){const t=((null==(f=j.flip)?void 0:f.index)||0)+1,n=z[t];if(n)return{data:{index:t,overflows:i},reset:{placement:n}};let e=null==(g=i.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:g.placement;if(!e)switch(A){case"bestFit":{const t=null==(x=i.map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:x[0];t&&(e=t);break}case"initialPlacement":e=o}if(a!==e)return{reset:{placement:e}}}return{}}}},e.hide=function(e){return void 0===e&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:i="referenceHidden",...o}=s(e,t);switch(i){case"referenceHidden":{const e=j(await r(t,{...o,elementContext:"reference"}),n.reference);return{data:{referenceHiddenOffsets:e,referenceHidden:p(e)}}}case"escaped":{const e=j(await r(t,{...o,altBoundary:!0}),n.floating);return{data:{escapedOffsets:e,escaped:p(e)}}}default:return{}}}}},e.inline=function(t){return void 0===t&&(t={}),{name:"inline",options:t,async fn(j){const{placement:h,elements:b,rects:d,platform:m,strategy:w}=j,{padding:_=2,x:p,y:f}=s(t,j),g=Array.from(await(null==m.getClientRects?void 0:m.getClientRects(b.reference))||[]),n=function(s){const n=s.slice().sort((e,t)=>e.y-t.y),e=[];let t=null;for(let o=0;o<n.length;o++){const s=n[o];!t||s.y-t.y>t.height/2?e.push([s]):e[e.length-1].push(s),t=s}return e.map(e=>c(y(e)))}(g),v=c(y(g)),l=u(_),r=await m.getElementRects({reference:{getBoundingClientRect:function(){if(2===n.length&&n[0].left>n[1].right&&null!=p&&null!=f)return n.find(e=>p>e.left-l.left&&p<e.right+l.right&&f>e.top-l.top&&f<e.bottom+l.bottom)||v;if(n.length>=2){if("x"===i(h)){const t=n[0],s=n[n.length-1],a="top"===e(h),o=t.top,r=s.bottom,i=a?t.left:s.left,c=a?t.right:s.right;return{top:o,bottom:r,left:i,right:c,width:c-i,height:r-o,x:i,y:o}}const d="left"===e(h),s=o(...n.map(e=>e.right)),t=a(...n.map(e=>e.left)),r=n.filter(e=>d?e.left===t:e.right===s),c=r[0].top,l=r[r.length-1].bottom;return{top:c,bottom:l,left:t,right:s,width:s-t,height:l-c,x:t,y:c}}return v}},floating:b.floating,strategy:w});return d.reference.x!==r.reference.x||d.reference.y!==r.reference.y||d.reference.width!==r.reference.width||d.reference.height!==r.reference.height?{reset:{rects:r}}:{}}}},e.limitShift=function(t){return void 0===t&&(t={}),{options:t,fn(d){const{x:w,y,placement:f,rects:n,middlewareData:h}=d,{offset:j=0,mainAxis:b=!0,crossAxis:v=!0}=s(t,d),p={x:w,y},o=i(f),a=_(o);let c=p[o],r=p[a];const u=s(j,d),l="number"==typeof u?{mainAxis:u,crossAxis:0}:{mainAxis:0,crossAxis:0,...u};if(b){const e="y"===o?"height":"width",t=n.reference[o]-n.floating[e]+l.mainAxis,s=n.reference[o]+n.reference[e]-l.mainAxis;c<t?c=t:c>s&&(c=s)}if(v){var m,g;const s="y"===o?"width":"height",t=["top","left"].includes(e(f)),i=n.reference[a]-n.floating[s]+(t&&(null==(m=h.offset)?void 0:m[a])||0)+(t?0:l.crossAxis),c=n.reference[a]+n.reference[s]+(t?0:(null==(g=h.offset)?void 0:g[a])||0)-(t?l.crossAxis:0);r<i?r=i:r>c&&(r=c)}return{[o]:c,[a]:r}}}},e.offset=function(t){return void 0===t&&(t=0),{name:"offset",options:t,async fn(a){const{x:r,y:c}=a,o=await async function(f,b){const{placement:o,platform:l,elements:v}=f,g=await(null==l.isRTL?void 0:l.isRTL(v.floating)),p=e(o),m=n(o),h="x"===i(o),c=["left","top"].includes(p)?-1:1,u=g&&h?-1:1,a=s(b,f);let{mainAxis:d,crossAxis:t,alignmentAxis:r}="number"==typeof a?{mainAxis:a,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...a};return m&&"number"==typeof r&&(t="end"===m?-1*r:r),h?{x:t*u,y:d*c}:{x:d*c,y:t*u}}(a,t);return{x:r+o.x,y:c+o.y,data:o}}}},e.rectToClientRect=c,e.shift=function(t){return void 0===t&&(t={}),{name:"shift",options:t,async fn(c){const{x:h,y:p,placement:b}=c,{mainAxis:v=!0,crossAxis:g=!1,limiter:j={fn:e=>{let{x:t,y:n}=e;return{x:t,y:n}}},...y}=s(t,c),f={x:h,y:p},d=await r(c,y),a=i(e(b)),l=_(a);let o=f[a],n=f[l];if(v){const e="y"===a?"bottom":"right";o=m(o+d["y"===a?"top":"left"],o,o-d[e])}if(g){const e="y"===l?"bottom":"right";n=m(n+d["y"===l?"top":"left"],n,n-d[e])}const u=j.fn({...c,[a]:o,[l]:n});return{...u,data:{x:u.x-h,y:u.y-p}}}}},e.size=function(t){return void 0===t&&(t={}),{name:"size",options:t,async fn(l){const{placement:j,rects:A,platform:v,elements:w}=l,{apply:k=()=>{},...E}=s(t,l),c=await r(l,E),m=e(j),d=n(j),_="x"===i(j),{width:h,height:u}=A.floating;let y,g;"top"===m||"bottom"===m?(y=m,g=d===(await(null==v.isRTL?void 0:v.isRTL(w.floating))?"start":"end")?"left":"right"):(g=m,y="end"===d?"top":"bottom");const O=u-c[y],x=h-c[g],f=!l.middlewareData.shift;let p=O,b=x;if(_){const e=h-c.left-c.right;b=d||f?a(x,e):e}else{const e=u-c.top-c.bottom;p=d||f?a(O,e):e}if(f&&!d){const e=o(c.left,0),t=o(c.right,0),n=o(c.top,0),s=o(c.bottom,0);_?b=h-2*(0!==e||0!==t?e+t:o(c.left,c.right)):p=u-2*(0!==n||0!==s?n+s:o(c.top,c.bottom))}await k({...l,availableWidth:b,availableHeight:p});const C=await v.getDimensions(w.floating);return h!==C.width||u!==C.height?{reset:{rects:!0}}:{}}}},Object.defineProperty(e,"__esModule",{value:!0})})